import{r as y,e as A,o as d,c as p,a as t,u as i,F as R,f as U,g as I,d as D,t as x,n as J,h as B,v as K,i as z,_ as Q,m as q,j as W,s as X,k as Y,l as Z}from"./DICxFz2T.js";const c=y({retries:3,retryDelay:1e3,timeout:5e3,cacheDuration:6e4,async:!1,override:!1,skipCache:!1,logging:!0});function H(){const m=y(new Map),n=y(new Map);function o(a,l,...f){if(c.value.logging){const $=new Date().toISOString();console[a](`[${$}] ${a.toUpperCase()}: ${l}`,...f)}}function e(a){const l=new AbortController,f=setTimeout(()=>{l.abort(),o("warn",`Request timed out after ${a}ms`)},a);return{controller:l,clearTimeout:()=>clearTimeout(f)}}function s(a,l){const f=new URLSearchParams(l).toString();return f?`${a}?${f}`:a}function u(a,l){return Date.now()-a<l}async function g({apiRequest:a,retries:l,retryDelay:f,cancellationToken:$,timeout:k,cacheDuration:_,skipCache:S},C){const{method:w,endpoint:b,headers:E={},queryParams:L={},body:O}=a,V=s(b,L);if(!S&&_&&_>0){const r=n.value.get(V);if(r&&u(r.timestamp,_))return o("info",`Returning cached response for: ${V}`),r.data}let v=$||new AbortController,M;if(k){const r=e(k);v=r.controller,M=r.clearTimeout}const h=v.signal;return(async()=>{o("info","Attempting network call",{endpoint:b,method:w,attempt:C});try{const r={method:w,headers:{"Content-Type":"application/json",...E},signal:h};["POST","PUT","PATCH"].includes(w)&&O&&(r.body=JSON.stringify(O));const P=await fetch(b,r);if(!P.ok)throw new Error(`Failed to fetch: ${P.statusText}`);const N=await P.json();return o("info","Network call successful",{endpoint:b,method:w,attempt:C,result:N}),_&&_>0&&(n.value.set(V,{data:N,timestamp:Date.now()}),o("info",`Response cached for: ${V}`,{cacheDuration:_})),N}catch(r){if(r.name==="AbortError")o("warn","Request aborted:",{endpoint:b});else return o("error","Request failed:",{error:r,endpoint:b}),r;if(l&&C<l)return o("warn",`Retrying... Attempt ${C+1}`,{endpoint:b,method:w,retryDelay:f}),await new Promise(P=>setTimeout(P,f)),g({apiRequest:a,retries:l,retryDelay:f,cancellationToken:$,timeout:k,cacheDuration:_,skipCache:S},C+1);throw r}finally{M&&M()}})()}async function T({apiRequest:a,async:l,override:f,retries:$,retryDelay:k,cancellationToken:_,timeout:S,cacheDuration:C,skipCache:w}){const{method:b,endpoint:E,headers:L={},queryParams:O={},body:V}=a,v={async:l!==void 0?l:c.value.async,override:f!==void 0?f:c.value.override,retries:$!==void 0?$:c.value.retries,retryDelay:k!==void 0?k:c.value.retryDelay,timeout:S!==void 0?S:c.value.timeout,cacheDuration:C!==void 0?C:c.value.cacheDuration,skipCache:w!==void 0?w:c.value.skipCache},M=new URLSearchParams(O).toString(),h=M?`${E}?${M}`:E;o("info","Starting API call",{url:h,method:b,mergedOptions:v}),m.value.has(h)&&(v.override?(m.value.get(h).controller.abort(),m.value.delete(h),o("info",`Aborted ongoing request for: ${h}`)):v.async||(o("info",`Waiting for ongoing request to complete for: ${h}`),await m.value.get(h).promise));const G=g({apiRequest:a,retries:v.retries,retryDelay:v.retryDelay,cancellationToken:_,timeout:v.timeout,cacheDuration:v.cacheDuration,skipCache:v.skipCache},0);m.value.set(h,{controller:_||new AbortController,promise:G});try{const r=await G;return o("info",`API call completed for: ${h}`,{result:r}),r}catch(r){throw o("error",`API call failed for: ${h}`,{error:r}),r}finally{m.value.delete(h)}}function F(a){c.value={...c.value,...a},o("info","Global config updated",{newConfig:a})}return{executeCall:T,updateGlobalConfig:F}}const ee={class:"method-container"},te={class:"method-menu"},oe={key:0},ne=["onClick"],se={class:"my-4"},le={class:"box"},re=A({__name:"APIMethod",setup(m){const n=j();return(o,e)=>(d(),p("div",ee,[e[2]||(e[2]=t("p",{class:"text-2xl bold my-2"},"Method Type",-1)),t("div",te,[i(n).httpMethods.length>0?(d(),p("ul",oe,[(d(!0),p(R,null,U(i(n).httpMethods,(s,u)=>(d(),p("li",{key:u,class:J({"active-method":i(n).httpMethods[u]===i(n).currentHttpsMethod}),onClick:g=>i(n).handleMethodTabClick(u)},x(s),11,ne))),128))])):I("",!0)]),t("p",se,[e[0]||(e[0]=D(" Testing ")),t("code",le,x(i(n).currentHttpsMethod),1),e[1]||(e[1]=D(" method "))])]))}}),ie={class:"method-container"},ae={class:"flex justify-around"},ue={class:"box"},de={class:"flex justify-between"},ce=["onUpdate:modelValue"],pe=["onUpdate:modelValue"],fe={key:2},me={class:"box"},he=A({__name:"GlobalConfig",setup(m){const{updateGlobalConfig:n}=H();return n(c.value),(o,e)=>(d(),p("div",ie,[e[2]||(e[2]=t("p",{class:"text-2xl bold my-2"},"Configure Defaults",-1)),t("div",ae,[t("div",ue,[e[0]||(e[0]=t("p",{class:"text-xl font-bold"},"Edit Default Values",-1)),(d(!0),p(R,null,U(i(c),(s,u,g)=>(d(),p("div",{key:g,class:"my-3"},[t("div",de,[t("label",null,x(u)+": ",1),typeof s=="string"||typeof s=="number"?B((d(),p("input",{key:0,type:"text","onUpdate:modelValue":T=>i(c)[u]=T},null,8,ce)),[[K,i(c)[u],void 0,{number:!0}]]):typeof s=="boolean"?B((d(),p("input",{key:1,type:"checkbox","onUpdate:modelValue":T=>i(c)[u]=T},null,8,pe)),[[z,i(c)[u]]]):(d(),p("span",fe,"Unsupported type"))])]))),128))]),t("div",me,[e[1]||(e[1]=t("p",{class:"text-xl font-bold"},"Live Preview of Default Values",-1)),t("pre",null,"                    "+x(i(c))+`
                `,1)])])]))}}),ve=Q(he,[["__scopeId","data-v-a101d3e6"]]),ye={class:"method-container"},ge={class:"w-100 flex flex-row justify-end"},_e=A({__name:"Response",setup(m){const n=j(),o=y("Copy"),e=async()=>{try{if(n.response.length<0)throw o.value="Response Empty!","Empty Response";await navigator.clipboard.writeText(JSON.stringify(n.response)),o.value="Copied!",setTimeout(()=>{o.value="Copy"},2e3)}catch(s){console.error("Failed to copy text:",s)}};return(s,u)=>(d(),p("div",ye,[u[0]||(u[0]=t("p",{class:"text-2xl bold my-2"},"Response",-1)),t("div",ge,[t("button",{onClick:e},x(i(o)),1)]),t("pre",null,"            "+x(i(n).response)+`
        `,1)]))}}),be={class:"method-container"},Ce={class:"method-menu"},we=A({__name:"APIEndpointSetup",setup(m){const n=j();return(o,e)=>(d(),p("div",be,[e[2]||(e[2]=t("p",{class:"text-2xl bold my-2"},"Endpoint Setup",-1)),e[3]||(e[3]=t("p",null,'Enter a custom endpoint with "https://" included.',-1)),e[4]||(e[4]=t("p",null,"Current default endpoint is 'https://dummyjson.com/products'",-1)),t("div",Ce,[B(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>i(n).endpoint=s)},null,512),[[K,i(n).endpoint]]),t("button",{onClick:e[1]||(e[1]=s=>i(n).handleTestButton()),class:"m-2"}," Test Opt Store ")])]))}}),xe=[{title:"Configure Globals",isVisible:!1,component:q(ve)},{title:"Configure Method Type",isVisible:!0,component:q(re)},{title:"Configure Endpoint",isVisible:!0,component:q(we)},{title:"Response",isVisible:!1,component:q(_e)}],j=W("playground",()=>{const{executeCall:m,updateGlobalConfig:n}=H(),o=X([...xe]),e=y(["GET","POST","DELETE","PUT","PATCH"]),s=y("GET"),u=y("https://dummyjson.com/products/1"),g=y({});return y({status:"idle",message:"Response State",data:{}}),{playgroundMainMenu:o,httpMethods:e,currentHttpsMethod:s,endpoint:u,response:g,toggleOptionView:l=>{o.value[l].isVisible=!o.value[l].isVisible},handleMethodTabClick:l=>{s.value!==e.value[l]&&(s.value=e.value[l])},handleTestButton:async()=>{g.value=await m({apiRequest:{endpoint:u.value,method:s.value},skipCache:!1}),g.value&&(o.value[3].isVisible||(o.value[3].isVisible=!0))}}}),$e={class:"method-container"},Te={class:"menu flex flex-row justify-between items-center"},ke={class:"main-menu"},Me={class:"flex flex-row"},Se=["onClick"],Ve={class:"my-4"},Pe={class:"box"},Ae=A({__name:"playground",setup(m){H();const n=j();return n.httpMethods,y(0),y(),n.endpoint,(o,e)=>(d(),p(R,null,[t("div",$e,[t("div",Te,[t("div",ke,[t("div",Me,[(d(!0),p(R,null,U(i(n).playgroundMainMenu,(s,u)=>(d(),p("div",null,[t("div",{class:J(`box m-1 button ${s.isVisible?"text-teal-400 bg-slate-700":""}`),onClick:g=>i(n).toggleOptionView(u)},[t("span",null,x(s.title),1)],10,Se)]))),256))])]),t("div",null,[t("p",Ve,[e[0]||(e[0]=D(" Testing ")),t("code",Pe,x(i(n).currentHttpsMethod),1),e[1]||(e[1]=D(" method "))])])])]),(d(!0),p(R,null,U(i(n).playgroundMainMenu,s=>(d(),p("div",null,[s.isVisible?(d(),Y(Z(s.component),{key:0,markRaw:""})):I("",!0)]))),256))],64))}});export{Ae as _};
